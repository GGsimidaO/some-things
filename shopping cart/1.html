<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			li {
				list-style: none;
				margin: 30px;
			}
			b {
				margin: 10px;
			}
		</style>
	</head>

	<body>
		<ul>
			<li goods="0">
				<span>鞋子</span>
				<b>100</b>
				<button>加入购物车</button>
			</li>
			<li goods="1">
				<span>袜子</span>
				<b>9.99</b>
				<button>加入购物车</button>
			</li>
			<li goods="2">
				<span>衬衫</span>
				<b>200</b>
				<button>加入购物车</button>
			</li>
			<li goods="3">
				<span>夹克</span>
				<b>300</b>
				<button>加入购物车</button>
			</li>
			<li goods="4">
				<span>长裤</span>
				<b>120</b>
				<button>加入购物车</button>
			</li>
		</ul>
		<a href="2.html">结算</a>
	</body>
	<script>
		var cookie = document.cookie;
		cookie = cookie.split("; ");
		cookie = cookie[0];
		cookie = cookie.split("=");
		cookie = cookie[1];
		var ul = document.querySelector("ul");
		var p = document.querySelector("p");
		cookie = JSON.parse(cookie);

		var ul = document.querySelector("ul");
		ul.onclick = (e) => {
			var e = e;
			if(e.target.nodeName.toLowerCase() == "button") {
				var obj = {};
				var id = e.target.parentNode.getAttribute("goods");
				var name = e.target.parentNode.childNodes[1].innerHTML;
				var price = e.target.parentNode.childNodes[3].innerHTML;
				console.log(id, name, price);
				obj.name = name;
				obj.id = id;
				obj.price = price;
				for(var i = 0; i < cookie.length; i++) {
					if(cookie[i].id == id) {
						obj.num = cookie[i].num + 1;
						cookie[i] = obj;
						break;
					}
				}
				if(i == cookie.length) {
					obj.num = 1;
					cookie.push(obj);
				}
				console.log(cookie);
				document.cookie = "listData=" + JSON.stringify(cookie);
			}
		}
	</script>

</html>
